---
title: "OkCupid For You: Find Your Future Friends and Partners"
author: Megan Resurreccion and Phillip Zelditch; STAT 385 Final Project
output: html_document
runtime: shiny
---


```{r,echo=FALSE}
OkCupid <- read.csv("https://uofi.box.com/shared/static/oy32nc373w4jqz3kummksnw6wvhfrl7a.csv")
library(tidyverse)
```


```{r, echo=FALSE}
library(shiny)
library(shinythemes)
#aesthetics and user interface
ui <- fluidPage(
  theme=shinytheme("sandstone"),
  mainPanel(
  navlistPanel(
    tabPanel("About the Project",
             fluidRow(column(width=12)),
             tags$p("On common dating apps, you don't get to find the right person for you. The app does. Conventional dating apps don't let you refine your searches for the people you're looking for. Finding friends and partners with stuff in common in real life can also be difficult. Find a better social life for you."),
             tags$br(),
             tags$p("Below you'll find the age distribution of profiles. Click on each of the tabs and choose an age range to look at the number of people with certain characteristics available!"),
             column(12,plotOutput("agedistribution"))
             ),
    tabPanel("By Body Type",
             fluidRow(column(width=12)),
             selectInput("age", "Select age range:",
             c("18-22","23-27","28-32","33-37","38-42","43-47","48-52","53-57","58-62","63-69"),
             selected="18-22"),
             column(12,plotOutput("whichbody")),
             selectInput("bodytype","Select body type:",
              c("Used Up","Thin","Skinny","Rather Not Say","Overweight","Jacked","Full Figured","Fit","Curvy","Average","Athletic","A Little Extra"))
             ),
    tabPanel("By Diet",
             fluidRow(column(width=12)),
             selectInput("age", "Select age range:",
             c("18-22","23-27","28-32","33-37","38-42","43-47","48-52","53-57","58-62","63-69"),
             selected = "18-22"),
             column(12,plotOutput("whichdiet")),
             selectInput("diettype","Select diet type:",
              c("Vegetarian","Vegan","Strictly Vegetarian","Strictly Vegan","Strictly Other", "Strictly Kosher", "Strictly Halal", "Strictly Anything", "Other", "Mostly Vegetarian", "Mostly Vegan", "Mostly Other", "Mostly Kosher", "Mostly Halal", "Mostly Anything", "Kosher", "Anything"))
             ),
    tabPanel("By Drinking Activity",
             fluidRow(column(width=12)),
             selectInput("age", "Select age range:",
             c("18-22","23-27","28-32","33-37","38-42","43-47","48-52","53-57","58-62","63-69"),
             selected = "18-22"),
             column(12,plotOutput("whichdrink")),
             selectInput("drinkact","Select drinking frequency:",
              c("Very Often","Socially","Rarely","Often","Not at All","Desperately"))
             ),
    tabPanel("By Pet Preference",
             fluidRow(column(width=12)),
             selectInput("age", "Select age range:",
             c("18-22","23-27","28-32","33-37","38-42","43-47","48-52","53-57","58-62","63-69"),
             selected = "18-22"),
             column(12,plotOutput("whichpet")),
             selectInput("petlike", "Select pet preference:",
              c("Likes Dogs and Cats","Likes Dogs and Has Cats","Likes Dogs and Dislikes Cats", "Likes Dogs", "Likes Cats", "Has Dogs and Likes Cats", "Has Dogs and Has Cats", "Has Dogs and Dislikes Cats", "Has Dogs", "Has Cats", "Dislikes Dogs and Likes Cats", "Dislikes Dogs and Has Cats", "Dislikes Dogs and Dislikes Cats", "Dislikes Dogs", "Dislikes Cats"))
             ),
    tabPanel("By Smoking Activity",
             fluidRow(column(width=12)),
             selectInput("age", "Select age range:",
             c("18-22","23-27","28-32","33-37","38-42","43-47","48-52","53-57","58-62","63-69"),
             selected = "18-22"),
             column(12,plotOutput("whichsmoke")),
             selectInput("smokefreq","Select smoking frequency activity:",
              c("Yes", "When Drinking", "Trying to Quit", "Sometimes", "No"))
             )
)
)
)

#create graphs and mess with data stuff
server <- function(input, output) {

output$agedistribution <- renderPlot({
  ggplot(data = OkCupid, aes(age)) + geom_bar() + labs(x = "Age of User", y = "Number of Users", title = "Number of Users by Age") + scale_x_discrete()
})

output$whichbody <- renderPlot({
  if(input$age == "18-22"){
    print("working!")
  OkCupid5 <- OkCupid %>% filter(age >= "18" & age <= "22", body_type != "")
ggplot(data = OkCupid5, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "23-27"){
    print("working too!")
  OkCupid10 <- OkCupid %>% filter(age >= "23" & age <= "27", body_type != "")
ggplot(data = OkCupid10, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "28-32"){
  OkCupid15 <- OkCupid %>% filter(age >= "28" & age <= "32", body_type != "")
ggplot(data = OkCupid15, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "33-37"){
OkCupid20 <- OkCupid %>% filter(age >= "33" & age <= "37", body_type != "")
ggplot(data = OkCupid20, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "38-42"){
OkCupid25 <- OkCupid %>% filter(age >= "38" & age <= "42", body_type != "")
ggplot(data = OkCupid25, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "43-47"){
OkCupid30 <- OkCupid %>% filter(age >= "43" & age <= "47", body_type != "")
ggplot(data = OkCupid30, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "48-52"){
OkCupid35 <- OkCupid %>% filter(age >= "48" & age <= "52", body_type != "")
ggplot(data = OkCupid35, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "53-57"){
OkCupid40 <- OkCupid %>% filter(age >= "53" & age <= "57", body_type != "")
ggplot(data = OkCupid40, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else if(input$age == "58-62"){
OkCupid45 <- OkCupid %>% filter(age >= "58" & age <= "62", body_type != "")
ggplot(data = OkCupid45, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
  else{
OkCupid50 <- OkCupid %>% filter(age >= "63" & age <= "69", body_type != "")
ggplot(data = OkCupid50, aes(body_type)) + geom_bar() + labs(x = "Body Type", y = "Number of Users", title = "Number of Users by Body Type") + coord_flip()
  }
})


output$whichsmoke <- renderPlot({
  if(input$age == "18-22"){
  OKCupid1 <- OkCupid %>% filter(age >= "18" & age <= "22", smokes != "")
ggplot(data = OKCupid1, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()
  }
  else if(input$age == "23-27"){
    OKCupid6 <- OkCupid %>% filter(age >= "23" & age <= "27", smokes != "")
ggplot(data = OKCupid6, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()
  }
  else if(input$age == "28-32"){
    c
  OKCupid11 <- OkCupid %>% filter(age >= "28" & age <= "32", smokes != "")
ggplot(data = OKCupid11, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age == "33-37"){
  OKCupid16 <- OkCupid %>% filter(age >= "33" & age <= "37", smokes != "")
ggplot(data = OKCupid16, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age == "38-42"){
  OKCupid21 <- OkCupid %>% filter(age >= "38" & age <= "42", smokes != "")
ggplot(data = OKCupid21, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age == "43-47"){
  OKCupid26 <- OkCupid %>% filter(age >= "43" & age <= "47", smokes != "")
ggplot(data = OKCupid26, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age == "48-52"){
  OKCupid31 <- OkCupid %>% filter(age >= "48" & age <= "52", smokes != "")
ggplot(data = OKCupid31, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age == "53-57"){
  OKCupid36 <- OkCupid %>% filter(age >= "53" & age <= "57", smokes != "")
ggplot(data = OKCupid36, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age =="58-62"){
  OKCupid41 <- OkCupid %>% filter(age >= "58" & age <= "62", smokes != "")
ggplot(data = OKCupid41, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else if(input$age == "63-69"){
  OKCupid46 <- OkCupid %>% filter(age >= "63" & age <= "69", smokes != "")
ggplot(data = OKCupid46, aes(smokes)) + geom_bar() + labs(x = "Smoking Habit", y = "Number of Users", title = "Number of Users by Smoking Habit") + coord_flip()  
  }
  else{
    print("fell through")
  }
})

output$whichdrink <- renderPlot({
  if(input$age == "18-22"){
    OKCupid2 <- OkCupid %>% filter(age >= "18" & age <= "22", drinks != "")
ggplot(data = OKCupid2, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()
  }
  else if(input$age == "23-27"){
  OKCupid7 <- OkCupid %>% filter(age >= "23" & age <= "27", drinks != "")
ggplot(data = OKCupid7, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age == "28-32"){
  OKCupid12 <- OkCupid %>% filter(age >= "28" & age <= "32", drinks != "")
ggplot(data = OKCupid12, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age == "33-37"){
  OKCupid17 <- OkCupid %>% filter(age >= "33" & age <= "37", drinks != "")
ggplot(data = OKCupid17, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age == "38-42"){
  OKCupid22 <- OkCupid %>% filter(age >= "38" & age <= "42", drinks != "")
ggplot(data = OKCupid22, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age == "43-47"){
  OKCupid27 <- OkCupid %>% filter(age >= "43" & age <= "47", drinks != "")
ggplot(data = OKCupid27, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age == "48-52"){
  OKCupid32 <- OkCupid %>% filter(age >= "48" & age <= "52", drinks != "")
ggplot(data = OKCupid32, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age == "53-57"){
  OKCupid37 <- OkCupid %>% filter(age >= "53" & age <= "57", drinks != "")
ggplot(data = OKCupid37, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else if(input$age=="58-62"){
  OKCupid42 <- OkCupid %>% filter(age >= "58" & age <= "62", drinks != "")
ggplot(data = OKCupid42, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
  else{
  OKCupid47 <- OkCupid %>% filter(age >= "63" & age <= "69", drinks != "")
ggplot(data = OKCupid47, aes(drinks)) + geom_bar() + labs(x = "Drinking Habit", y = "Number of Users", title = "Number of Users by Drinking Habit") + coord_flip()  
  }
})

output$whichpet <- renderPlot({
  if(input$age == "18-22"){
  OKCupid3 <- OkCupid %>% filter(age >= "18" & age <= "22", pets != "")
ggplot(data = OKCupid3, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()
  }
  else if(input$age == "23-27"){
  OKCupid8 <- OkCupid %>% filter(age >= "23" & age <= "27", pets != "")
ggplot(data = OKCupid8, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else if(input$age == "28-32"){
  OKCupid13 <- OkCupid %>% filter(age >= "28" & age <= "32", pets != "")
ggplot(data = OKCupid13, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else if(input$age == "33-37"){
  OKCupid18 <- OkCupid %>% filter(age >= "33" & age <= "37", pets != "")
ggplot(data = OKCupid18, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference")  + coord_flip()  
  }
  else if(input$age == "38-42"){
  OKCupid23 <- OkCupid %>% filter(age >= "38" & age <= "42", pets != "")
ggplot(data = OKCupid23, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else if(input$age == "43-47"){
  OKCupid28 <- OkCupid %>% filter(age >= "43" & age <= "47", pets != "")
ggplot(data = OKCupid28, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else if(input$age == "48-52"){
  OKCupid33 <- OkCupid %>% filter(age >= "48" & age <= "52", pets != "")
ggplot(data = OKCupid33, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else if(input$age == "53-57"){
  OKCupid38 <- OkCupid %>% filter(age >= "53" & age <= "57", pets != "")
ggplot(data = OKCupid38, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else if(input$age=="58-62"){
  OKCupid43 <- OkCupid %>% filter(age >= "58" & age <= "62", pets != "")
ggplot(data = OKCupid43, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
  else{
  OKCupid48 <- OkCupid %>% filter(age >= "63" & age <= "69", pets != "")
ggplot(data = OKCupid48, aes(pets)) + geom_bar() + labs(x = "Pet Preference", y = "Number of Users", title = "Number of Users by Pet Preference") + coord_flip()  
  }
})

output$whichdiet <- renderPlot({
  if(input$age == "18-22"){
   OkCupid4 <- OkCupid %>% filter(age >= "18" & age <= "22", diet != "")
ggplot(data = OkCupid4, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()  
  }
  else if(input$age == "23-27"){
   OkCupid9 <- OkCupid %>% filter(age >= "23" & age <= "27", diet != "")
ggplot(data = OkCupid9, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()  
  }
  else if(input$age == "28-32"){
  OkCupid14 <- OkCupid %>% filter(age >= "28" & age <= "32", diet != "")
ggplot(data = OkCupid14, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()
  }
  else if(input$age == "33-37"){
  OkCupid19 <- OkCupid %>% filter(age >= "33" & age <= "37", diet != "")
ggplot(data = OkCupid19, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet")+ coord_flip()  
  }
  else if(input$age == "38-42"){
  OkCupid24 <- OkCupid %>% filter(age >= "38" & age <= "42", diet != "")
ggplot(data = OkCupid24, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()  
  }
  else if(input$age == "43-47"){
  OkCupid29 <- OkCupid %>% filter(age >= "43" & age <= "47", diet != "")
ggplot(data = OkCupid29, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()
  }
  else if(input$age == "48-52"){
  OkCupid34 <- OkCupid %>% filter(age >= "48" & age <= "52", diet != "")
ggplot(data = OkCupid34, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()  
  }
  else if(input$age == "53-57"){
  OkCupid39 <- OkCupid %>% filter(age >= "53" & age <= "57", diet != "")
ggplot(data = OkCupid39, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()  
  }
  else if(input$age=="58-62"){
  OkCupid44 <- OkCupid %>% filter(age >= "58" & age <= "62", diet != "")
ggplot(data = OkCupid44, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()  
  }
  else{
    OkCupid49 <- OkCupid %>% filter(age >= "63" & age <= "69", diet != "")
ggplot(data = OkCupid49, aes(diet)) + geom_bar() + labs(x = "Diet", y = "Number of Users", title = "Number of Users by Diet") + coord_flip()
  }
})

}


shinyApp(ui = ui, server = server)
```